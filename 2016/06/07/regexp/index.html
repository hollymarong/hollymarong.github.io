<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>正则表达式 | marong blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="String.prototype.match() String.prototype.replace()  RegExp.prototype.exec()   RegExp.prototype.test()  元字符   字符 含义     ^ 匹配字符串的开头，多行检索中，匹配一行的开头   $ 匹配字符串的结尾，多行检索中，匹配一行的结尾   \b 匹配一个单词的边界   \B 匹配而非单词的">
<meta property="og:type" content="article">
<meta property="og:title" content="正则表达式">
<meta property="og:url" content="http://yoursite.com/2016/06/07/regexp/index.html">
<meta property="og:site_name" content="marong blog">
<meta property="og:description" content="String.prototype.match() String.prototype.replace()  RegExp.prototype.exec()   RegExp.prototype.test()  元字符   字符 含义     ^ 匹配字符串的开头，多行检索中，匹配一行的开头   $ 匹配字符串的结尾，多行检索中，匹配一行的结尾   \b 匹配一个单词的边界   \B 匹配而非单词的">
<meta property="og:updated_time" content="2017-05-16T01:02:10.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="正则表达式">
<meta name="twitter:description" content="String.prototype.match() String.prototype.replace()  RegExp.prototype.exec()   RegExp.prototype.test()  元字符   字符 含义     ^ 匹配字符串的开头，多行检索中，匹配一行的开头   $ 匹配字符串的结尾，多行检索中，匹配一行的结尾   \b 匹配一个单词的边界   \B 匹配而非单词的">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">marong blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Less is more</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
  <a href="https://github.com/hollymarong"><img style="position: absolute; top: 0; right: 0; border: 0;z-index:2;" src="https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png"></a>
</header>

      <div class="outer">
        <section id="main"><article id="post-regexp" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/06/07/regexp/" class="article-date">
  <time datetime="2016-06-07T03:45:08.000Z" itemprop="datePublished">2016-06-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      正则表达式
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li>String.prototype.match()</li>
<li><p>String.prototype.replace()</p>
</li>
<li><p>RegExp.prototype.exec() </p>
</li>
<li>RegExp.prototype.test()</li>
</ul>
<h2 id="元字符"><a href="#元字符" class="headerlink" title="元字符"></a>元字符</h2><table>
<thead>
<tr>
<th style="text-align:left">字符</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">^</td>
<td style="text-align:left">匹配字符串的开头，多行检索中，匹配一行的开头</td>
</tr>
<tr>
<td style="text-align:left">$</td>
<td style="text-align:left">匹配字符串的结尾，多行检索中，匹配一行的结尾</td>
</tr>
<tr>
<td style="text-align:left">\b</td>
<td style="text-align:left">匹配一个单词的边界</td>
</tr>
<tr>
<td style="text-align:left">\B</td>
<td style="text-align:left">匹配而非单词的边界</td>
</tr>
<tr>
<td style="text-align:left">(?=p)</td>
<td style="text-align:left">零宽正向先行断言，要求接下来的字符都与p匹配，但不能包括匹配p的那些字符</td>
</tr>
<tr>
<td style="text-align:left">(?!p)</td>
<td style="text-align:left">零宽负向先行断言，要求接下来的字符不与p匹配</td>
</tr>
<tr>
<td style="text-align:left">(?&lt;=p)</td>
<td style="text-align:left">javscript不支持</td>
</tr>
<tr>
<td style="text-align:left">(?&lt;!p)</td>
<td style="text-align:left">javascript不支持</td>
</tr>
<tr>
<td style="text-align:left">(?&gt;p)</td>
<td style="text-align:left">固化分组, javascript不支持</td>
</tr>
</tbody>
</table>
<h2 id="量词"><a href="#量词" class="headerlink" title="量词"></a>量词</h2><table>
<thead>
<tr>
<th style="text-align:left">字符</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">?</td>
<td style="text-align:left">0次货1次</td>
</tr>
<tr>
<td style="text-align:left">+</td>
<td style="text-align:left">一次或多次</td>
</tr>
<tr>
<td style="text-align:left">*</td>
<td style="text-align:left">0次或多次</td>
</tr>
<tr>
<td style="text-align:left">{n}</td>
<td style="text-align:left">n次</td>
</tr>
<tr>
<td style="text-align:left">{n,}</td>
<td style="text-align:left">n次或更多次</td>
</tr>
<tr>
<td style="text-align:left">{n, m}</td>
<td style="text-align:left">次数在n,m之间,至少n次，但不能超过m次</td>
</tr>
</tbody>
</table>
<h3 id=""><a href="#" class="headerlink" title="."></a>.</h3><p>. 不能匹配回车和换行\n, \r</p>
<h3 id="匹配包含p-但不包含h的所有单词"><a href="#匹配包含p-但不包含h的所有单词" class="headerlink" title="匹配包含p, 但不包含h的所有单词"></a>匹配包含p, 但不包含h的所有单词</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> web_development = <span class="string">"python php ruby javascript jsonp perhapsphpisoutdated"</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/\bp(?!h)\w*\b/g</span>;</div><div class="line">web_development.match(reg); <span class="comment">//["python", "perhapsphpisoutdated"]</span></div></pre></td></tr></table></figure>
<h3 id="零宽断言"><a href="#零宽断言" class="headerlink" title="零宽断言"></a>零宽断言</h3><p>js 中，对于四种零宽断言，只支持 零宽度正预测先行断言 和 零宽度负预测先行断言 这两种。</p>
<p>js 中，正则表达式后面可以跟三个 flag，比如 /something/igm。</p>
<p>他们的意义分别是，</p>
<p>i 的意义是不区分大小写<br>g 的意义是，匹配多个<br>m 的意义是，是 ^ 和 $ 可以匹配每一行的开头。</p>
<p>javascript不支持“零宽度正回顾后发断言”</p>
<h3 id="子表达式"><a href="#子表达式" class="headerlink" title="(?: 子表达式)"></a>(?: 子表达式)</h3><ul>
<li>定义非捕获组,只分组不捕获<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Write(?:Line)</div><div class="line">var reg = /Write(?:Line)/;</div><div class="line">var dd = &apos;Console.WriteLine()&apos;;</div><div class="line">dd.match(reg)  //[&apos;WriteLine&apos;]</div><div class="line"></div><div class="line">var reg = /Write(Line)/;</div><div class="line">var dd = &apos;Console.WriteLine()&apos;;</div><div class="line">dd.match(reg)  //[&apos;WriteLine&apos;, &apos;Line&apos;];</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="子表达式-1"><a href="#子表达式-1" class="headerlink" title="(?= 子表达式)"></a>(?= 子表达式)</h3><ul>
<li>仅当子表达式在此位置的右侧匹配时才继续匹配。例如，\w+(?=\d) 与后跟数字的单词匹配，而不与该数字匹配<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var ss = /^\W*(?=空气质量)|[^&gt;]*(?=&lt;\/b&gt;)/g;</div><div class="line">var dd = &apos;北京空气质量：&lt;b&gt;90&lt;/b&gt;&apos;;</div><div class="line">var rr = dd.match(ss); //[&quot;北京&quot;, &quot;90&quot;, &quot;&quot;]</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="lt-子表达式"><a href="#lt-子表达式" class="headerlink" title="(?&lt;= 子表达式)"></a>(?&lt;= 子表达式)</h3><ul>
<li>（零宽度正回顾后发断言。） 仅当子表达式在此位置的左侧匹配时才继续匹配。例如，(?&lt;=19)99 与跟在 19 后面的 99 的实例匹配。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">'Homes Tea is good, hometown is beautiful'</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/(?&lt;=\bhome)(?=s\b)/gi</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/(?=s\b)(?&lt;=\bhome)/gi</span>;<span class="comment">//位置变化没有影响</span></div><div class="line">str.replace(reg, <span class="string">"'"</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
<p>格式化数字<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> num = <span class="string">'1234876'</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/(?&lt;=\d)(?=(\d\d\d)+$)/gi</span>;</div><div class="line">num.replace(reg, <span class="string">','</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> num = <span class="string">'hello, here is 1234876 str'</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/(?&lt;=\d)(?=(\d\d\d)+\b)/gi</span>;</div><div class="line">num.replace(reg, <span class="string">','</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> num = <span class="string">'hello, here is 1234876kg str'</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/(?&lt;=\d)(?=(\d\d\d)+(?!\d))/gi</span>;</div><div class="line">num.replace(reg, <span class="string">','</span>);</div></pre></td></tr></table></figure></p>
<p>匹配空格间隔的字符串<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">var</span> cls=<span class="string">"item current"</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/(?&lt;=\s*)([^\s]+)(?=\s*)/</span>;</div><div class="line">cls.match(reg);</div><div class="line"><span class="string">``</span><span class="string">` </span></div><div class="line"></div><div class="line"></div><div class="line">1.[...]字符组</div><div class="line">一个字符组只能匹配目标文本的单个字符，在字符组内部，只有连字符才是元字符（如果连字符出现在字符组的开头，只表示一个普通的字符），?.等元字符在字符组内部就是一个普通字符, \在字符组内需要转义。</div><div class="line">`<span class="string">``</span>javascript</div><div class="line"><span class="comment">//真正的特殊字符只有两个连字符</span></div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/[1-9A-Z_!.?]/</span>;</div></pre></td></tr></table></figure></p>
<ol>
<li>| 或，子表达式称为多选分支<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">//匹配gray，grey</div><div class="line">var reg = /gray|grey/;</div><div class="line">var reg = /gr(a|e)y/;</div><div class="line">var reg = /gr[ae]y/;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>3.反向引用<br>匹配与表达式先前部分匹配的同样的文本。在一个表达式中，可以使用多个括号，\1,\2,\3等用来表示第一，第二，第三组括号匹配的文本。括号是按照开括号(从左到右的出现顺序进行的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">//匹配字符串中重复出现的单词</div><div class="line">var ss = &apos;hello world  world;</div><div class="line">var reg = /\b([A-Za-z]+) +\1\b/;</div><div class="line">reg.exec(ss)</div></pre></td></tr></table></figure></p>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><ul>
<li><p>匹配引号内的字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var ss = &apos;Some on said &quot;Programing is fun&quot;&apos;;</div><div class="line">var reg = /&quot;[^&quot;]*&quot;/;</div><div class="line">var result = reg.exec(ss);</div></pre></td></tr></table></figure>
</li>
<li><p>匹配时间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">//9:17 am 12:30pm</div><div class="line">var reg = /(0?[1-9]|1[012]):[0-5][0-9] *(a|m)p/;</div><div class="line">//09:59 24小时制</div><div class="line">var reg = /([01]?[0-9]|2[0-3]):[0-5][0-9]/;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="正则表达式的匹配原则"><a href="#正则表达式的匹配原则" class="headerlink" title="正则表达式的匹配原则"></a>正则表达式的匹配原则</h3><ul>
<li>量词? * + {min, max}都是贪婪匹配的，尽可能多的匹配字符，直到达到匹配上限为止。</li>
<li>量词?? *? +? {min, max}?都是懒惰匹配的，尽可能少的匹配字符，只需满足匹配下限。</li>
<li>占有优先量词: ?+ *+ ++ {min, max}+都是贪婪匹配的，在匹配的过程中不会交还任何匹配到的字符(javascript不支持)。</li>
<li>先来先服务原则<br>先满足先来的量词的贪婪匹配，后来的量词满足最基本的匹配.<br>.<em>会贪婪匹配整个字符串,只有在全局匹配需要的情况下，才会被迫交出一些字符<br>为了满足\d{4}的匹配，强迫.\</em>从右到左交还字符（保证.*匹配的最基本的条件），直到满足匹配，下面能匹配2017.<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"this year is 2017"</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/^.*+(\d&#123;4&#125;)/</span>;</div><div class="line"><span class="keyword">var</span> result = reg.exec(str);</div><div class="line">result[<span class="number">1</span>] <span class="comment">//2017</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>下面的结果只能匹配到7,根据先来先服务的原则，满足\d+最基本的匹配一次<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"this year is 2017"</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/^.*(\d+)/</span>;</div><div class="line"><span class="keyword">var</span> result = reg.exec(str);</div><div class="line">result[<span class="number">1</span>] <span class="comment">//7</span></div></pre></td></tr></table></figure></p>
<p>下面的结果什么都匹配不到,根据先来先服务的原则，满足\d*最基本的匹配0次<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"this year is 2017"</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/^.*(\d*)/</span>;</div><div class="line">reg.exec(str);</div><div class="line"><span class="keyword">var</span> result = reg.exec(str);</div><div class="line">result[<span class="number">1</span>] <span class="comment">//''</span></div></pre></td></tr></table></figure></p>
<h3 id="排除类和排除环视"><a href="#排除类和排除环视" class="headerlink" title="排除类和排除环视"></a>排除类和排除环视</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">'Tom said "hello what\'s your name?", Jim answered:"hello, my name is Jim"'</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/"(.*)"/</span>;</div><div class="line">reg.exec(str); <span class="comment">//"hello what\'s your name?", Jim answered:"hello, my name is Jim"</span></div></pre></td></tr></table></figure>
<ul>
<li><p>采用排除法<br>如果匹配一个字符用排除法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">'Tom said "hello what\'s your name?", Jim answered:"hello, my name is Jim"'</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/"([^"]*)"/</span>;</div><div class="line">reg.exec(str); <span class="comment">//"hello what\'s your name?"</span></div></pre></td></tr></table></figure>
</li>
<li><p>采用.*?,忽略优先量词的匹配</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">'Tom said "hello what\'s your name?", Jim answered:"hello, my name is Jim"'</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/"(.*?)"/</span>;</div><div class="line">reg.exec(str); <span class="comment">//"hello what\'s your name?"</span></div></pre></td></tr></table></figure>
</li>
<li><p>采用排除环视，来匹配某个字符串<br>匹配出<b></b>之间的内容,排除法，忽略匹配优先的量词的方法都不能满足;<br>排除法针对的单个字符，而不是有着特定顺序的字符串<br>忽略匹配优先的量词的方法，对于<b>…<b>..</b>这种情况匹配不正确;</b></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var str = "&lt;b&gt;hello &lt;em&gt;marong&gt;&lt;/em&gt;&lt;/b&gt; &lt;b&gt;wow&lt;/b&gt;";</div><div class="line">var reg = /&lt;b&gt;((?!&lt;/?b&gt;).)*&lt;\/b&gt;/;</div><div class="line">reg.exec(ss);</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="固化分组-gt-和占有优先的量词-min-max"><a href="#固化分组-gt-和占有优先的量词-min-max" class="headerlink" title="固化分组(?&gt;)和占有优先的量词(?+,*+, {min, max}+)"></a>固化分组(?&gt;)和占有优先的量词(?+,*+, {min, max}+)</h3><p>固化分组和占有优先的量词能提高效率<br>固化分组匹配成功后，会抛弃固化分组里的备用状态<br><figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//perl</div><div class="line">$str = <span class="string">"hello"</span>;</div><div class="line">$str =~ <span class="regexp">/(\w+):/</span>;<span class="regexp">//</span>\w+匹配整个字符串后，不断后退回溯，来匹配:,直到匹配到e，表达式宣告失败，效率低 </div><div class="line">$str =~ <span class="regexp">/(?&gt;\w+):/</span>; <span class="regexp">//</span>固化分组</div><div class="line">$str =~ <span class="regexp">/\w++:/</span>; <span class="regexp">//</span>占有优先</div></pre></td></tr></table></figure></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">//perl</div><div class="line">$num = <span class="number">27.624300009</span>;</div><div class="line"><span class="comment"># $num =~ s/(\.\d\d[1-9]?)\d*/$1/; //27.624, 对于正好三位数27.625也会进行匹配，效率不高</span></div><div class="line"><span class="comment"># $num =~ s/(\.\d\d[1-9]?)\d+/$1/; //27.62, 对于27.625不能正确匹配</span></div><div class="line">$num =~ <span class="regexp">s/(\.\d\d(?&gt;[1-9]?))\d+/$1/</span>;<span class="regexp">//</span><span class="number">27.624</span>, 固化分组，匹配成功后，不会再释放</div><div class="line">$num =~ <span class="regexp">s/(\.\d\d([1-9]?+))\d+/$1/</span>;<span class="regexp">//</span><span class="number">27.624</span>, 占有优先量词,匹配成功后，不会再释放</div><div class="line"><span class="keyword">print</span> <span class="string">"\$num: $num .\n"</span>;</div></pre></td></tr></table></figure>
<p>javascript不支持,固化分组和占有优先的量词，但可以通过环视模拟来实现固化分组<br>对于环视，只会匹配成功或失败，不会保留备用状态，跟固化分组的行为一直，只是环视虽然能捕获，但不是全局匹配的一部分。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var str =&quot;hello&quot;;</div><div class="line">//var reg = /(?&gt;\w+)/;//如果javascript支持固化分组</div><div class="line">var reg = /(?=(\w+))\1/; //模拟捕获</div><div class="line">reg.exec(str);</div></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> num = <span class="number">23.624</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/(\.\d\d[1-9]?)\d*/</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/(\.\d\d(?=[1-9])\2)\d*/</span>;</div><div class="line">reg.exec(num);</div></pre></td></tr></table></figure>
<h3 id="多选结构"><a href="#多选结构" class="headerlink" title="多选结构|"></a>多选结构|</h3><p>需要仔细安排多选结构的顺序<br><figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$str = <span class="string">"Jan 31 is Dad's birthday"</span>;</div><div class="line"><span class="comment"># $str =~ /Jan (0?[0-9]|[12][0-9]|3[01])/; //Jan 3,第一个表达式能匹配到3</span></div><div class="line">$str =~ <span class="regexp">/Jan (3[01]|[12][0-9]|0?[0-9])/</span>;  <span class="regexp">//</span>Jan <span class="number">31</span>,调整多选的顺序</div><div class="line"><span class="keyword">print</span> <span class="string">"\$str: $&amp;"</span>;</div></pre></td></tr></table></figure></p>
<h3 id="正则实例"><a href="#正则实例" class="headerlink" title="正则实例"></a>正则实例</h3><ul>
<li><p>匹配路径和文件名</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//javascript</span></div><div class="line"><span class="keyword">var</span> path = <span class="string">'/Users/marong/test/index.js'</span>;</div><div class="line"><span class="keyword">var</span> path = <span class="string">'/Users//marong/test///index.js'</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/(.*\/)?(.*)/</span>;</div><div class="line">reg.exec(path);</div></pre></td></tr></table></figure>
</li>
<li><p>匹配一个浮点数<br>下面这个正则表达式能匹配到任何数字或字符串，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> num = <span class="number">2.12</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/-?[0-9]*\.?[0-9]*/</span>; <span class="comment">//能匹配到任何数组,因为表达式的每一项都不是必须的，能匹配到任何字符串开头的空字符</span></div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/-?([0-9]+(\.[0-9]+)?|\.[0-9]+)/</span>; <span class="comment">//能匹配到任何数</span></div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/^-?[0-9]*\.?[0-9]*$/</span>; <span class="comment">//能匹配到任何数字和空字符串</span></div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/^-?([0-9]+(\.[0-9]+)?|\.[0-9]+)$/</span>; <span class="comment">//能匹配到任何数</span></div><div class="line">reg.test(num);</div></pre></td></tr></table></figure>
</li>
<li><p>匹配双引号之间的内容</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">'Dash Symbol: "/-|-\\" or "[*_*]"'</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/"(\\.|[^"])*"/</span>;</div><div class="line">reg.exec(str);</div></pre></td></tr></table></figure>
</li>
<li><p>去掉首尾的字符</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"  hello  world, I will test some regexp speed, check the regexp speed    "</span>;</div><div class="line"><span class="keyword">var</span> regStart = <span class="regexp">/^\s+/</span>;</div><div class="line"><span class="keyword">var</span> regEnd = <span class="regexp">/\s+$/</span>;</div><div class="line"><span class="keyword">var</span> result;</div><div class="line"><span class="keyword">var</span> start = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line"><span class="keyword">var</span> count = <span class="number">1000000</span>;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>;i &lt; count; i++)&#123;</div><div class="line">    result = str.replace(regStart,<span class="string">''</span>).replace(regEnd, <span class="string">''</span>);</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'normal time'</span>, +<span class="keyword">new</span> <span class="built_in">Date</span> - +start, <span class="string">'result'</span>, result);<span class="comment">//317</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/^\s+(.*?)\s+$/</span>;</div><div class="line">start = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>;i &lt; count; i++)&#123;</div><div class="line">    result = str.replace(reg,<span class="string">'$1'</span>);</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'? time'</span>, +<span class="keyword">new</span> <span class="built_in">Date</span> - +start, <span class="string">'result'</span>, result);<span class="comment">// 314</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/^\s+|\s+$/g</span>;</div><div class="line">start = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>;i &lt; count; i++)&#123;</div><div class="line">    result = str.replace(reg,<span class="string">''</span>);</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'| time'</span>, +<span class="keyword">new</span> <span class="built_in">Date</span> - +start, <span class="string">'result'</span>, result);<span class="comment">//309</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/^\s+((?:.*\S)?)\s+$/</span>;</div><div class="line">start = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>;i &lt; count; i++)&#123;</div><div class="line">    result = str.replace(reg,<span class="string">'$1'</span>);</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'\\S time'</span>, +<span class="keyword">new</span> <span class="built_in">Date</span> - +start, <span class="string">'result'</span>, result);<span class="comment">//260</span></div></pre></td></tr></table></figure>
</li>
<li><p>匹配HTML标签</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">'&lt;span data-sp="&gt;" class="item" title=""&gt;&lt;/span&gt;'</span>;</div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/&lt;[^&gt;]*&gt;/g</span>;<span class="comment">//不能匹配标签里含有&gt;的情况</span></div><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/&lt;("[^"]"|'[^']'|[^'"&gt;])*&gt;/g</span>;<span class="comment">//能匹配标签里含有&gt;的情况</span></div><div class="line"><span class="keyword">var</span> result = str.match(reg);</div><div class="line"><span class="built_in">console</span>.log(result);  <span class="comment">//result [ '&lt;span data-sp="&gt;" class="item" title=""&gt;', '&lt;/span&gt;' ]</span></div></pre></td></tr></table></figure>
</li>
<li><p>匹配HTML Link</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">'&lt;a class="navitem" data-sp="&gt;" data-name=test href="http://marong.me/blog"   title="marong blog"   &gt;hello marong&lt;/a&gt;'</span>;</div><div class="line"><span class="comment">// var regA = /&lt;a\b([^&gt;]*)&gt;(.*?)&lt;\/a&gt;/;</span></div><div class="line"><span class="keyword">var</span> regA = <span class="regexp">/&lt;a\b(('[^']*'|"[^"]*"|[^'"&gt;])*)&gt;(.*?)&lt;\/a&gt;/</span>;</div><div class="line"><span class="keyword">var</span> aResult = str.match(regA);</div><div class="line"><span class="keyword">var</span> regHref = <span class="regexp">/href\s*=\s*('[^']*'|"[^"]*"|[^'"&gt;\s]*/</span>;</div><div class="line"><span class="keyword">var</span> hrefResult = aResult &amp;&amp; aResult[<span class="number">1</span>] &amp;&amp; aResult[<span class="number">1</span>].match(regHref);;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'aResult'</span>,aResult);;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'hrefResult'</span>,hrefResult);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'href='</span>,hrefResult[<span class="number">1</span>], <span class="string">'  value='</span>,aResult[<span class="number">3</span>]);</div><div class="line"><span class="comment">//href =  "http://marong.me/blog" value =  hello marong</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="优化正则表达式"><a href="#优化正则表达式" class="headerlink" title="优化正则表达式"></a>优化正则表达式</h2><ul>
<li><p>字符组比多选结构的效率高<br>多选结构可能需要回溯，捕获型的括号处理也需要时间</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> timesTodo = <span class="number">100000</span>;</div><div class="line"><span class="keyword">var</span> testStr = <span class="string">'ababadedfg'</span>;</div><div class="line"></div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++)&#123;</div><div class="line">    testStr += testStr;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> count = timesTodo;</div><div class="line"><span class="keyword">var</span> start  = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line"><span class="keyword">while</span>(count--)&#123;</div><div class="line">    /^(a|b|c|d|e|f|g)$/.test(testStr);</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'alternation takes seconds.\n'</span>, <span class="keyword">new</span> <span class="built_in">Date</span> - start);<span class="comment">//107</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> count = timesTodo;</div><div class="line"><span class="keyword">var</span> start  = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line"><span class="keyword">while</span>(count--)&#123;</div><div class="line">        /^[a-g]$/.test(testStr);</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'charactor class takes seconds.\n'</span>, <span class="keyword">new</span> <span class="built_in">Date</span> - start);<span class="comment">//12</span></div></pre></td></tr></table></figure>
</li>
<li><p>使用非捕获型括号(?:)<br>如果不需要引用括号内的文本，节省捕获的时间，坚守回溯使用的状态的数量。</p>
</li>
<li>使用起始锚点<br>如果要匹配某个字符串的开头位置字符，添加起始锚点，能提高匹配的速度。</li>
<li>将文字文本独立出来,提高引擎识别的可能性</li>
</ul>
<ul>
<li><p>从量词中提取必须的元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/x+/ ---&gt; /xx*/</div><div class="line">/-&#123;5,7&#125;/ ---&gt; /-----&#123;0, 2&#125;/</div></pre></td></tr></table></figure>
</li>
<li><p>提取多选结构开头必须的元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/(?:that|this)/ ---&gt; /th(?:at|is)/</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li>匹配优先，忽略匹配优先，排除性字符组<br>/.<em>:/<br>匹配优先，匹配到最后一个冒号，如果分号比较接近结尾，速度更快<br>/.</em>?:/<br>忽略优先匹配，匹配到第一个冒号,如果分号比较接近开头，速度更快<br>/[^:]*:/<br>匹配到第一冒号，一般比忽略匹配优先效率要高</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/06/07/regexp/" data-id="cj2zlj5aa000qhhx9po1x26kb" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/06/09/git-commandline/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          git-commandline
        
      </div>
    </a>
  
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Emacs/">Emacs</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Perl/">Perl</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Server/">Server</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vim/">Vim</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mac/">mac</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/svn/">svn</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/">webpack</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/CSS/" style="font-size: 15px;">CSS</a> <a href="/tags/Emacs/" style="font-size: 10px;">Emacs</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/JavaScript/" style="font-size: 20px;">JavaScript</a> <a href="/tags/Perl/" style="font-size: 10px;">Perl</a> <a href="/tags/Server/" style="font-size: 10px;">Server</a> <a href="/tags/Vim/" style="font-size: 10px;">Vim</a> <a href="/tags/algorithm/" style="font-size: 10px;">algorithm</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/svn/" style="font-size: 10px;">svn</a> <a href="/tags/webpack/" style="font-size: 10px;">webpack</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/05/22/jsEqualOperator/">Javascript相等操作符</a>
          </li>
        
          <li>
            <a href="/2017/05/22/cssMarginPaddingPercentage/">CSS中百分比值</a>
          </li>
        
          <li>
            <a href="/2017/05/10/mac-commandline/">mac-commandline</a>
          </li>
        
          <li>
            <a href="/2017/04/30/perlstart/">Perl入门</a>
          </li>
        
          <li>
            <a href="/2017/04/26/box-model/">box-model</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 marong<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>